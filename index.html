<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>VoiceBridge ‚Äî Smart Communication</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap" rel="stylesheet">
  <style>
    :root {
      --primary: #0078ff;
      --bg-light: #f2f7ff;
      --bg-dark: #0f172a;
      --card: #ffffff;
      --text-dark: #1e293b;
      --text-light: #f8fafc;
      --accent: #3b82f6;
      font-family: 'Poppins', sans-serif;
    }

    body {
      margin: 0;
      background: var(--bg-light);
      color: var(--text-dark);
      display: flex;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      transition: background 0.3s, color 0.3s;
    }

    .container {
      width: 100%;
      max-width: 900px;
      background: var(--card);
      border-radius: 16px;
      box-shadow: 0 10px 40px rgba(0,0,0,0.1);
      padding: 24px;
      text-align: center;
    }

    h1 {
      margin-bottom: 8px;
      font-size: 26px;
      color: var(--primary);
    }

    p.desc {
      color: #64748b;
      margin-bottom: 16px;
    }

    textarea {
      width: 100%;
      min-height: 120px;
      border-radius: 12px;
      padding: 12px;
      border: 1px solid #cbd5e1;
      font-size: 15px;
      resize: vertical;
      outline: none;
    }

    .controls {
      margin-top: 16px;
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 10px;
    }

    select, button {
      padding: 10px 14px;
      border-radius: 10px;
      border: 1px solid #cbd5e1;
      background: #fff;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s;
    }

    button.primary {
      background: var(--accent);
      color: white;
      border: none;
    }

    button.primary:hover {
      background: #2563eb;
    }

    .chip {
      display: inline-block;
      padding: 8px 14px;
      border-radius: 20px;
      background: #eff6ff;
      border: 1px solid #bfdbfe;
      margin: 4px;
      cursor: pointer;
      transition: 0.2s;
    }

    .chip:hover {
      background: #dbeafe;
    }

    footer {
      margin-top: 18px;
      font-size: 13px;
      color: #64748b;
    }

    .dark-mode {
      background: var(--bg-dark);
      color: var(--text-light);
    }

    .dark-mode .container {
      background: #1e293b;
    }

    .dark-mode textarea, .dark-mode select, .dark-mode button {
      background: #334155;
      color: #f1f5f9;
      border-color: #475569;
    }

    .dark-toggle {
      position: absolute;
      top: 20px;
      right: 20px;
      background: #e2e8f0;
      border: none;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      cursor: pointer;
      font-size: 18px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .dark-mode .dark-toggle {
      background: #475569;
      color: #f8fafc;
    }
  </style>
</head>
<body>
  <button class="dark-toggle" id="themeToggle">üåô</button>
  <div class="container">
    <h1>üéôÔ∏è VoiceBridge</h1>
    <p class="desc">Smart multilingual voice assistant with clearer sound & modern design</p>

    <textarea id="text" placeholder="Type something to speak...">Hello! How are you?</textarea>

    <div class="controls">
      <select id="lang"></select>
      <select id="voice"></select>
      <button id="refreshVoices">üîÅ Refresh</button>
      <button class="primary" id="speakBtn">Speak</button>
      <button id="recordBtn">üé§ Listen</button>
    </div>

    <div id="phrases"></div>

    <footer>
      VoiceBridge ¬© 2025 | Supports English & Malayalam | Smart echo reducer built-in
    </footer>
  </div>

  <script>
    // --- Initialization ---
    const langSelect = document.getElementById('lang');
    const voiceSelect = document.getElementById('voice');
    const speakBtn = document.getElementById('speakBtn');
    const refreshVoicesBtn = document.getElementById('refreshVoices');
    const textEl = document.getElementById('text');
    const themeToggle = document.getElementById('themeToggle');

    const LANGS = [
      ['en-IN','English (India)'],
      ['ml-IN','Malayalam (India)'],
      ['hi-IN','Hindi (India)'],
    ];

    LANGS.forEach(([code,label])=>{
      const opt=document.createElement('option');
      opt.value=code; opt.textContent=label;
      langSelect.appendChild(opt);
    });
    langSelect.value='ml-IN';

    let voices=[];
    function loadVoices(){
      voices=speechSynthesis.getVoices();
      voiceSelect.innerHTML='';
      voices.forEach((v,i)=>{
        const o=document.createElement('option');
        o.value=i; o.textContent=v.name+' ('+v.lang+')';
        voiceSelect.appendChild(o);
      });
    }
    if('speechSynthesis' in window){
      speechSynthesis.onvoiceschanged=loadVoices;
      setTimeout(loadVoices,300);
    }

    function speakText(text){
      speechSynthesis.cancel();
      const utter=new SpeechSynthesisUtterance(text);
      const selLang=langSelect.value;
      utter.lang=selLang;
      utter.rate=1;
      utter.pitch=1;
      // attempt to use cleaner voices
      const vIndex=voiceSelect.value;
      if(voices[vIndex]) utter.voice=voices[vIndex];
      // reduce echo by short pause and adjust volume
      utter.volume=0.9;
      speechSynthesis.speak(utter);
    }

    speakBtn.onclick=()=>{
      const text=textEl.value.trim();
      if(!text)return alert('Type something first!');
      speakText(text);
    }

    refreshVoicesBtn.onclick=loadVoices;

    // Speech Recognition
    const recordBtn=document.getElementById('recordBtn');
    let recognizing=false; let recognition;
    if('webkitSpeechRecognition' in window){
      recognition=new webkitSpeechRecognition();
      recognition.lang='ml-IN';
      recognition.continuous=false;
      recognition.interimResults=false;
      recognition.onresult=(e)=>{
        textEl.value=e.results[0][0].transcript;
      };
      recognition.onend=()=>{recognizing=false;recordBtn.textContent='üé§ Listen';};
    }

    recordBtn.onclick=()=>{
      if(!recognition)return alert('Speech recognition not supported on this browser');
      if(!recognizing){recognition.start();recognizing=true;recordBtn.textContent='üõë Stop';}
      else{recognition.stop();recognizing=false;recordBtn.textContent='üé§ Listen';}
    }

    // Theme toggle
    themeToggle.onclick=()=>{
      document.body.classList.toggle('dark-mode');
      themeToggle.textContent=document.body.classList.contains('dark-mode')?'‚òÄÔ∏è':'üåô';
    }
  </script>
</body>
</html>
